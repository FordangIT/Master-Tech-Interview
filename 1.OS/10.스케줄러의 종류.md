# 스케줄러(Scheduler)

스케줄링 알고리즘 전에 스케줄러에 대해 먼저 알아보자.

프로세스들은 실행이 종료될 때까지 여러 개의 큐를 거쳐가며 실행된다. OS는 이러한 큐에 있는 프로세스들 중 어떤 프로세스를 선택해 cpu를 할당할지를 결정하는 역할을 한다. 이 역할을 수행하는 것이 바로 `스케줄러(Scheduler)`이다.

스케줄러가 관리하는 주요 큐들.

- **작업 큐(Job Queue)**:현재 시스템 내에 존재하는 모든 프로세스들의 집합이다. 프로세스들이 생성되면 가장 먼저 이 큐에 들어간다.
- **준비 큐(Ready Queue)**: 현재 메모리 내에 있으며, cpu를 할당받아 실행되기 위해 대기 중인 프로세스들의 집합이다. 스케줄러는 이 큐에서 프로세스를 선택해 cpu를 할당한다.
- **장치 큐(Device Queue)**: 각 장치마다 서비스(입출력)을 기다리며 대기 중인 프로세스들의 집합이다. 프로세스는 I/O 작업을 수행하기 위해 장치 큐에서 대기하게 된다.

이러한 큐들은 스케줄러가 어떤 프로세스를 언제 실행할지 결정하는 데 중요한 역할을 하며, 시스템의 효율적인 자원 관리를 가능하게 한다.

## 장기 스케줄러 (Long-term Scheduler)

장기 스케줄러는 메모리와 디스크 사이에서 프로세스의 스케줄링을 담당한다. 메모리는 한정되어 있는데 많은 프로세스들이 메모리에 한꺼번에 올라올 경우, 대용량 메모리(디스크)에 임시로 저장한다. 장기 스케줄러는 디스크에 저장된 프로세스들 중에서 어떤 프로세스를 메모리에 적재할지 결정하는 역할을 한다.

**주요 특징**

- **메모리 적재 결정**:장기 스케줄러는 디스크에 저장된 프로세스 중에서 어떤 순서로 메모리에 적재할지 결정한다. 이를 통해 메모리와 디스크 간의 프로세스 이동을 관리한다.
- **호출 빈도**: 장기 스케줄러는 상대적으로 호출 빈도가 낮다. 메모리와 디스크 사이의 스케줄링을 담당하기 때문에 메모리 적재가 자주 발생하지 않는다. 즉, 디스크와 같은 저장 장치에 작업들을 저장해 놓고 필요할 때 실행할 작업을 Job Queue에서 꺼내 Ready Queue를 통해서 메인 메모리에 적재한다.
- **Degree of Multiprogramming 제어**: 장기 스케줄러는 메모리에 동시에 존재하는 프로세스의 수, 즉 멀티프로그래밍의 정도를 제어한다. 이는 시스템의 성능과 효율성을 높이기 위해 중요하다.
- **프로세스 상태 전환**: 장기 스케줄러는 프로세스의 상태를 전환한다. 예를 들어, 새로운 프로세스가 생성되어 준비 상태(Ready)로 전환되거나, 프로세스가 실행 상태(Running) or Ready에서 종료 상태(Terminated)로 전활될 때 이를 관리한다.

장기 스케줄러는 시스템의 전체적인 성능과 자원 관리를 최적화하기 위해 중요한 역할을 한다. 이를 통해 운영체제는 메모리와 디스크 간의 자원 분배를 효율적으로 관리할 수 있다.

## 단기 스케줄러 (Short-term Scheduler)

단기 스케줄러는 CPU와 메모리 사이에서 프로세스 스케줄링을 담당하는 중요한 역할을 한다. 따라서 장기 스케줄러에 비해 훨씬 더 자주 호출되며, 주된 역할은 CPU에게 필요한 데이터를 확보하고, 메모리에 있는 프로세스들 중 하나를 선택하여 CPU에 할당하는 것이다.

**주요 특징**

- **프로세스 선택 및 할당**: 단기 스케줄러는 Ready Queue에 존재하는 여러 프로세스들 중에서 어떤 프로세스를 Running 상태로 전환시킬지를 결정한다. 이때, 보통 먼저 도착한 프로세스에게 CPU를 할당한다.
- **디스패처 역할**: 단기 스케줄러는 디스패처의 역할을 하여, 선택된 프로세스가 실제로 CPU에서 실행되도록 준비한다. 이 과정에서 프로세스의 컨텍스트(레지스터, 프로그램 카운터 등)를 CPU에 로드한다.
- **프로세스 상태 전환 관리**: 프로세스는 ready => running => waiting => ready 상태로 전환되며, 단기 스케줄러는 이 과정에서 프로세스 상태를 관리한다.

단기 스케줄러의 효율성은 시스템의 성능에 큰 영향을 미치며, 적절한 프로세스 스케줄링 알고리즘을 통해 시스템의 반응 시간을 최적화할 수 있다.

### CPU에게 필요한 데이터를 확보한다는 표현에 대하여

단기 스케줄러는 프로세스가 실행될 준비가 되었을 때 cpu가 해당 프로세스를 실행할 수 있도록 필요한 준비를 한다는 뜻이다.

- **1. 프로세스 컨텍스트 로드**: cpu가 특정 프로세스를 실행하려면 해당 프로세스의 컨텍스트(레지스터 상태, 프로그램 카운터 등)가 cpu 레지스터에 로드되어야 한다. 단기 스케줄러는 실행할 프로세스를 선택하고, 이 프로세스의 컨텍스트를 cpu에 로드하는 과정을 관리한다.
- **2. 메모리 접근 준비** :실행할 프로세스의 명령어와 데이터가 메모리에 존재해야 cpu가 이를 읽고 실행할 수 있다. 단기 스케줄러는 이러한 메모리 접근이 원활하게 이루어지도록 메모리 관리와 협력하여 프로세스가 필요로 하는 데이터가 메모리에 적재되었는지를 확인한다.
- **3. 캐시 관련 작업**: 프로세스의 효율적인 실행을 위해 cpu 캐시에 필요한 데이터를 적재하는 과정도 포함될 수 있다. 이 부분은 스케줄러가 직접 처리하기보다는 하드웨어적 레벨에서 이루어지지만, 단기 스케줄러의 결정에 의해 cpu 캐시 활용이 달라질 수 있다.

## 중기 스케줄러 (Medium-term Scheduler)

중기 스케줄러는 주로 시분할 시스템에서 사용되며, 메모리에 대한 과부하를 완화하고 시스템의 효율성을 높이기 위해 도입되었다. 이 스케줄러는 CPU를 차지하려는 프로세스 간의 경쟁이 심해질 때 우선순위가 낮은 프로세스를 일시적으로 메모리에서 제거하고, 나중에 경쟁이 완화되었을 때 해당 프로세스를 다시 메모리로 불러와 실행하는 역할을 한다. 이 과정에서 **스와핑(Swapping) 기법**이 사용된다.

**주요 역할 및 특징**:

- **메모리 관리 완화**: 중기 스케줄러는 메모리에서 실행 중인 프로세스들을 관리하여, 메모리 자원이 부족해질 경우 우선순위가 낮거나 즉시 필요하지 않은 프로세스를 디스크로 내보내는 역할을 한다. 이렇게 함으로써 동시에 적재되는 프로세스의 수를 조절하고, 메모리 자원의 효율적 사용을 도모한다.
- **스와핑(Swapping) 기법**: 프로세스간 경쟁이 치열할 때, 중기 스케줄러는 특정 프로세스를 메모리에서 디스크로 내보내여 메모리 공간을 확보한다. 나중에 시스템 자원이 여유로워지면 해당 프로세스를 다시 메모리로 불러와 이전에 중단된 지점부터 실행을 재개한다. 이 과정은 시스템의 성능을 최적화하고 응답성을 유지하는데 중요한 역할을 한다.
- **프로세스의 상태 전환**: 중기 스케줄러에 의해 메모리에서 제거된 프로세스는 Suspended 상태가 된다. 이후 다시 메모리로 불러와질 때 Ready 상태로 전환되어 cpu 할당을 기다리게 된다.

**프로세스의 상태 전환 예시**:

- [Swap out] Ready => Suspended : 프로세스가 메모리에서 디스크로 스와핑될 때.
- [Swap in] Suspended => Ready : 프로세스가 디스크에서 다시 메모리로 불러와질 때.
